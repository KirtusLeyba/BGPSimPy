%&pdflatex
\documentclass[10pt, conference, letterpaper]{IEEEtran}

\usepackage{xcolor}
\usepackage{subcaption}
\usepackage{graphicx}
\usepackage{todonotes}

%\newcommand{\toolname}{BGP-SAS}
%\newcommand{\toolname}{BGP Path Finder}
\newcommand{\toolname}{BGP Path Guide}
\newcommand{\timerange}{(2012-2018)}

\newcommand{\Ben}[2][1=]{\todo[linecolor=red,backgroundcolor=red!25,bordercolor=red,#1]{#2}}
\newcommand{\Steph}[2][1=]{\todo[linecolor=yellow,backgroundcolor=yellow!25,bordercolor=yellow,#1]{#2}}

%Titles:
%\title{The Evolution of National AS Chokepoints and Their Connection to
%Internet Freedom}
\title{Borders and Gateways: Measuring and Analyzing National AS Chokepoints}


\graphicspath{{./images/}}

\begin{document}
\maketitle

% \begin{abstract}Internet topology has been measured and modeled for many years, and this topology has been linked to censorship and surveillance. Past studies have not, however, quantified the potential for individual nations to intercept national level Internet paths or analyzed how the evolution of the Internet topology impacts censorship and surveillance. Over the past decade, governments around the world have recognized that the Internet is a powerful tool for controlling and surveilling their citizens, and they have begun enacting common policies for ASes operating within their borders.

%   In this paper, we ask how AS topology has changed over time with respect to national boundaries.  We introduce a new measure, \emph{national chokepoint potential}, to characterize how a country's AS topology is organized in terms of paths that can carry traffic across international borders.  To study country-level chokepoints, we developed \toolname{}, a suite of open source, cross platform, and efficient tools for monitoring national chokepoints on the AS graph.  To illustrate these ideas and tools, we studied how national chokepoint potential correlates with two independent measures of civil liberty, finding a significant relationship between our measure and Internet freedom. \todo[inline]{NEED A RESULT FOR WHAT WE FOUND FOR EVOLUTION OVER TIME}.

% This paper extends earlier research on AS topology and BGP simulation to study chokepoints across the Internet over multiple years, using our
% path simulation and routing tree datasets to view snapshots of the Internet
% over multiple years. We provide comprehensive and accessible tools for studying
% the complex and dynamic AS level Internet topology. Through this approach we
% can more carefully evaluate the state of the Internet than was previously possible.
% \end{abstract}

\begin{abstract}
	Internet topology has been measured and modeled for many years, and this topology has been linked to 
	censorship and surveillance. Past studies have not, however, quantified the potential for individual 
	nations to intercept national level Internet paths or analyzed how the evolution of the Internet 
	topology impacts censorship and surveillance. We introduce a new measure, \emph{national breakthrough
	potential}, or NBP, to characterize how a country's AS topology is organized in terms of paths that can carry 
	traffic across international borders.  To study country-level chokepoints, we developed \toolname{}, a 
	suite of open source, cross platform, and efficient tools for monitoring national chokepoints on the 
	AS graph. 
	We find that for many nations the continuous growth of the AS graph is not reflected by a more open
	flow of information across national borders, and in fact for nations known to conduct censorship we
	identify a trend toward strengthening chokepoints. Additionally, we find that a significant 
	relationship exists between NBP and Internet freedom as evaluated from two qualitative sources.
\end{abstract}


%% Paths on the Autonomous Systems (AS) graph of the Internet
%% derived from the Border Gateway Protocol (BGP) can be used by researchers to
%% understand the dynamics of Internet topology and to interpret how that
%% topology may enable nations to enact censorship, surveillance, or other
%% Internet control measures. Unfortunately datasets of these paths are not
%% generally made publicly available, and paths collected from measurements such as
%% traceroute or BGP probes tend to be incomplete. Simulation
%% frameworks have been used to generate AS paths based on inferred AS relationships.
%% We introduce \toolname, a suite of open source, cross platform, and efficient
%% tools for monitoring national chokepoints on the AS graph. We introduce chokepoint potential as an important measure of a nation's ability to 
%% control Internet traffic, either through censorship or surveillance.
%% Previous research endeavors in this
%% direction have only identified chokepoints in single snapshots. We apply our
%% path simulation and routing tree datasets to view snapshots of the Internet
%% over multiple years in order to introduce a new technique to investigate the
%% evolution of the complex and dynamic AS level Internet topology. Through this approach we
%% can more carefully evaluate the state of the Internet than was previously possible. As an
%% application of \toolname we compare Freedom House's Freedom On The Net (FOTN) score for
%% Internet freedom and with our chokepoint potential measure in order to interpret
%% the relationship between AS-level topology and actual censorship activity, providing an
%% illustration of new ways to monitor which governments can easily control the flow of 
%% information in their nations and whether they are acting on that potential.

\section{Introduction}

\par Widespread Internet censorship and surveillance pose a
significant threat to individuals throughout the world. As routine
tasks, communications, entertainment, and information move online and
are mediated by the Internet, most of us have little choice about
whether or not to rely on the Internet.  According to the
International Telecommunication Union (ITU), the number of individual
Internet users increased from 1.024 billion in 2005 to 3.578 billion
in 2017 \cite{itu}. The majority of these users operate in an
environment that restricts Internet freedom in some way. For example,
the 2017 Freedom on the Net report from Freedom House reports that
64\% of Internet users belong to a nation with Internet that is not
free or partly free \cite{FOTN}.  Beyond censorship and surveillance,
the EU is considering content rules surrounding copyright, net
neutrality rules in the U.S.\ were recently overturned, and large
content services are under enormous pressure to 'do
something' about fake news and bad actors. Also, other forms of Internet
tampering such as code injection~\cite{badtraffic,191996} have been observed within the
Internet's backbone. Taken together, these
trends will likely restructure the Internet in unforeseen ways,
as organizations respond to new challenges and realities.

Today, most such control is exercised at the country level,
as governments have recognized both the threat and the opportunity
that is posed by ubiquitous online communication. For example, much
of the organization, revolutionary momentum, and broadcasting of
events during the Arab Spring have been attributed to social media
communications through the Internet \cite{arabspring}. Several countries
sought to control these movements by disconnecting in-country networks from the rest of the world \cite{BGPdisrupt}.
These two factors, increasing levels of content monitoring and
Internet dependence, point to the need for improved tools and methods
for studying worldwide Internet censorship and surveillance over time.
\todo[inline]{A SENTENC OR TWO HERE SUMMARIZING THE STATE OF THE FIELD AND WHAT'S
  MISSING.}  

\par
In this paper, we focus on the Autonomous Systems (AS) level of the Internet.
Autonomous Systems are groups of routers under common management, such as the network of
a University or an Internet Service Provider (ISP). We apply AS-level topologies to
censorship and surveillance by evaluating border ASes, or ASes that can connect directly to at least
one AS from another nation according to a new measure \emph{chokepoint potential}.
With this measure we can ask how AS topology has changed over time with respect
to national boundaries.  We define \emph{national breakthrough potential} to
measure how a country's AS topology is organized in terms of paths
that can carry traffic across international borders. We developed a
suite of tools, called \toolname{}, for studying national chokepoints on
the AS graph efficiently. To illustrate these ideas and tools, we
study how national chokepoint potential correlates with two independent
measures of civilian liberty, finding that a significan relationship exists between NBP and both liberty measures.
The paper extends earlier research on AS topology, first by introducing the NBP measure, 
then by presenting open-source cross-platform tools for simulating Border Gateway Protocol (BGP) paths,
determining breakthrough potential at the country level, and analyzing how this measure has changed over time for certain countries of interest.


%Whether or not AS-level topology supports
%these efforts is a research question pivotal to an understanding of
%the dynamics of Internet censorship and surveillance.

%% \par
%% The Internet has been used as a tool for the citizens of authoritarian nations to voice opinions,
%% organize revolutionary movements, and connect with other nations' governments and citizens
%% to seek aid. Much of the organization, revolutionary momentum, and broadcasting
%% of happenings during the Arab Spring can be attributed to social media communications
%% through the Internet \cite{arabspring}. Because of this potential, national governments may
%% take interest in maximizing their ability to control the flow of information on the Internet.
%Censorship and Surveillance are growing phenomena

%The Internet is Dynamic and growing

The change in national AS topologies is of interest to censorship research.
The total size of the AS graph (The global network of all ASes) has grown from about 10,000 ASes in the early 2000s to over 60,000 today. 
The structural properties of national subgraphs have evolved differently
from nation to nation whether from economic decision making, infrastructural necessities, or efforts to build a powerful censorship and surveillance
network.
%The Autonomous Systems (AS) layer of the Internet has grown and changed dramatically over its history.
%The locations and relationships of these ASes determine how many chokepoints
%of AS-level routing exist and what strength these chokepoints have in regards to paths intercepted.
This rapid expansion, together with the changing role of national
governments, points to the importance of understanding properties like
path robustness, AS hierarchies, and the potential for organizations to
control information as it flows in and out of their networks.

%Current Events

%Diverse Censorship Architecture
\par Every nation has a different layout and number of ASes, and these national networks
connect to foreign ASes in unique ways. The
censorship and surveillance strategies of nations also differ. For
instance, China both conducts keyword filtering in border ASes and in
internal provincial ASes \cite{chinafiltering}, while Iran routes its
Internet traffic through a centralized facility \cite{irancensor}.
A picture of a nation's censorship or surveillance capabillities then
is not complete without a topological view point.
Having the capabillity to investigate the AS topology of a nation, then, will both help
researchers identify nations that could easily conduct censorship and
also provide possible insight into what kind of censorship is likely
being conducted. Our measure of border ASes, chokepoint potential, defined in detial
in section 3, is a succint way to estimate the important properties of
border ASes related to these capabilities, and our aggregate extension of this measure to
the national level, national breakthrough potential, is an effective way to evaluate and
compare nations and analyze the evolution of the AS-level censorship and surveillance landscape.

% Major Contributions
\par
The primary contributions of our work are as follows: 
\begin{enumerate}
 \item We introduce the measure of chokepoint potential for single border ASes and the aggregate measure national breakthrough potential, 
motivating their value as a way to interpret the capability for a nation to enact censorship or surveillance of its Internet traffic.
 \item We provide an overview of the evolution of national AS-level chokepoints over time, showing how the evolution of the Internet has either facillitated stronger
 AS-level chokepoints or lead to more open flow of information across borders.
 \item We develop a new tool, \toolname{}, that provides the capability for
efficiently evaluating chokepoints for a given state of the Internet. 
 \item We show that national breakthrough potential
has a significant relationship to Internet freedom as measured by two qualitative sources.
\end{enumerate}


% Rest of Paper Layout
\par
The layout of the rest of this paper is as follows: Section 2 provides relavent background information
to the problems we are investigating; Section 3 introduces and defines the measures of chokepoint
potential and national breakthrough potential; Section 4 details our tool for simulating and evaluating AS topologies \toolname{}; Section 5
explains our experimental setups; Sections 6, 7, and 8 provide results, discussion, and related work
respectively.

\section{Background}

The AS-layer is the highest level of organization of the Internet, with each individual AS represents a separately administered network, for example, a large ISP, a university network, or a government entity. The Border Gateway Protocol (BGP) is used to route traffic among ASes \cite{bgp}.  AS-level routes are known as \emph{paths} and are specified by routing tables stored locally in each AS. These tables express known connections to other ASes and local preferences for how data are routed, e.g., if there are multiple paths to a single destination, an AS may prefer the path that costs the least.

Because BGP is a distributed protocol, with all connectivity
information stored in the local routing tables, it is challenging to
infer the exact AS topology at any point in time.  Several strategies have been developed to infer AS topology, but none of them is perfect.  Methods that rely
on routing table information and BGP
updates suffer from the fact that BGP paths stored in routing tables
reflect only the current knowledge of a single AS about the routes
available~\cite{BGPStream}.
% FIXME: Not sure what BGPStream citation is for.  We need a different citation for RIPE unless that is what BGPStream is.
Thus one would need to use many sources to infer an accurate
picture of the BGP topology, which is not easily scalable for
global studies, particularly those looking at multiple time periods.
Similarly, methods based on empirical traceroute data are known to be incomplete or inaccurate~\cite{tracerouteProblems}.

\par AS-level studies are further complicated by the lack of ground
truth data for AS relationships and BGP paths. For AS relationships,
inference is often used based on economic considerations to classify
the relationships of ASes. This was first done by Gao \cite{gao} by
maximizing the occurances of certain economic rules on the AS graph by
choosing a particular set or relationships. This technique was only
evaluated against a single ISPs set of true relationships, however. As
part of the CAIDA project, this inference technique was extended,
leading to the CAIDA AS-relationship dataset \cite{CAIDApaper},
\cite{CAIDA}. We choose these relationships for our purposes, and they
are the current research standard.

\par Finding BGP paths is more of
a challenge. Packet based simulations, wherein BGP is simulated
directly, are computationally infeasible for the scales relevant to a
global study. An accurate, but realistic, simulation technique must be
chosen to provide useful research potential in this regard.  The
BGPSim algorithm \cite{quicksand} is one such simulation technique
that is suitable for this study's purposes. BGPSim takes a set of AS
relationships as input, such as those provided by the CAIDA dataset
\cite{CAIDA}, and returns routing trees based off of these
relationships. These paths are found via a modified breadth-first
seach (BFS) algorithm. The BFS adds edges to routing trees first
according to local preference (LP), then shortest path (SP), and
finally tiebreak (TB).  A resulting routing tree contains all the
equally reasonable paths (according to economic concerns) that exist
between source ASes (within the routing tree) to destination ASes (the
root of the routing tree). We find this technique suitable for our
purposes, so we extend BGPSim (in ways explained further in this
paper) as part of \toolname{}.

\section{Chokepoint Measures}


\begin{figure}
	\centering
	\includegraphics[width=\linewidth]{bnodes}
	\caption{The ratio of ASes that are border ASes plotted over several years.}\label{fig:bnodes}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=\linewidth]{chokepoint}
	\caption{Chokepoint potential example. ASes A,B, and C are all border ASes. 
						AS D is an internal AS. ASes E and F are both external ASes.
						The out-to-in chokepoint potentials of A,B, and C are 0.25, 0.25, and 0.5 respectively.}\label{fig:chokepoint}
\end{figure}


Border ASes are ASes that lie one hop from an AS registered to a different country. It stands to reason that if information bottlenecks
were to be implemented by national governments, they would likely be implemented on border ASes. This is not always true, but there are more reasons
to use border ASes as our unit of investigation. For instance, the ratio of the number of border ASes of
a country to all ASes in that country hints toward the abillity of that nation to intercept information flows across their borders.
\figurename \ref{fig:bnodes} shows that globally the number of border ASes has grown at a slower rate to the number of non-border ASes
over time so that the ratio of border ASes to ASes has almost continuously decreased. On the surface it would seem that this fact reflects an ever increasing capability for nations to intercept AS-level paths. This is not
neccessarily the case, however. Because AS-level paths are generated by the distributed BGP and the local preferences of AS administrators often do not
lead to simple shortest path selections, a better way to understand the potential for bottlenecks on border ASes is to investigate the number of BGP generated
paths that pass through each AS. To do this we propose an intuitive measure on border ASes called \emph{chokepoint potential}. Since this is a measure for single ASes
we also need an aggregate measure for comparing nations, which we call \emph{national breakthrough potential}.

% % Why Border ASes?
% In order to identify AS chokepoints and compare nations, we need a measure that can be calculated from the many paths between
% ASes. First, we decided to use a measure that is evaluated only on border ASes, or ASes that lie one hop from an AS belonging to another nation. 
% The evolution of AS relationships and national boundaries on the AS graph hints that border ASes are an important feature in regards to the flow
% of information. Consider that while the number of ASes globally has continued to grow rapidly, the number of border ASes has grown more slowly.
% This result is depicted in figure \ref{fig:bnodes}. Additionally, while internal chokepoints may intercept many paths, those paths are required
% to have entered through a border AS (in the case of out-to-in paths) or exit through a border AS (for in-to-out paths). This focus on border ASes has
% the added benefit of making calculations more efficient.

\par
For our measures we use the term \textit{path} to indicate a path that is generated by BGP consisting of a source AS, a destination AS, and the intermediate
ASes between them. We define a \textit{routing tree} to be a tree rooted at a single destination AS and composed of every acceptable BGP path from the various source ASes that can reach the destination AS.
We define the chokepoint potential of a border AS to be the ratio of paths intercepted by that border AS
to the number of paths intercepted by all border ASes belonging to the same nation. For instance, take a border AS $b$, belonging to country $c$.
If $P_c$ is the set of paths in to or out of country $c$ and $B_p$ is the set of border ASes within path $p$, then the
chokepoint potential of $b$, $CP(b)$ is defined formally in equation \ref{eqn:chokePointPotential}. This measure captures
the relative strength exhibited by a border AS in regards to what portion of paths it intercepts. This is calculated
seperately for in-to-out paths (those starting from a source in the country in question) and out-to-in paths. The out-to-in chokepoint potential for a simple dummy nations
is included in \figurename \ref{fig:chokepoint}.

% Formal Definition
\begin{equation}\label{eqn:chokePointPotential}
CP(b) = \frac{|\{p \in P_c \textrm{ s.t. } \{b\} \subseteq B_p\}|}{\sum_{p \in P_c}|B_p|}
\end{equation}

\par
Given a set of routing trees, chokepoint potential is an intuitive way to compare individual ASes. With this measure,
the sum of the chokepoint potential for all border ASes for a country is 1.0, as in, all of the border ASes collectively control the
flow of information over the nation's border. To compare one nation to another, we can inspect how many border ASe minimum are required
to obtain a certain chokepoint potential. The more border ASes required, the more difficult it would likely be for that nation to perform
censorship or surveillance, as the government would have to restrict more ISPs, place more filtering hardware, etc. Thus, we can define
another measure, with this one being a national measure. We define the \emph{national breakthrough potential} of a nation to be the minimum number
of ASes required to intercept a selected percentage of AS-level paths. Previous work has used 90\% path interception as a benchmark indicating strong control
of information \cite{throats}, so we use this percentage as well. When used here, however, 90\% path interception indicates a single nation intercepts 90\% of the paths
that either enter said nation (for the out-to-in case) or exit said nation (for the in-to-out case). National breakthrough potential is calculated taking the strongest ASes first,
such that the measure reflects the smallest number of border ASes needed to intercept the paths. We use the number of ASes here and not a percentage because using a percentage would
make it difficult to compare nations. Take for instance the United States, which has many more ASes than most nations. If the United States and another nation both required the same percentage
of border ASes to intercept 90\% of paths, the similarity of these nations would be misleading, because the United States would actually need to control many more ASes.
Our technique provides a comparison more likely to reflect reality. This measure is called a breakthrough potential because it indicates the number of border ASes that intercept a vast majority of paths, meaning that a country with high NBP would require controlling many border ASes to prevent a breakthrough, or an unfettered access of
internal ASes to that country.

\section{\toolname}

% Preprocessing and Data pipeline
\toolname{} is a new tool that calculates the chokepoint potential for every border AS given a set of AS relationships as well as the national breakthrough potential
for all nations represented by the AS graph.
\toolname{} first takes the entire AS graph, as in from the CAIDA dataset \cite{CAIDA}, and uses the principles of BGPSim \cite{quicksand}
to generate a set of routing trees. These routing trees, as well as a set of AS country codes (for identifying which nation an AS belongs to)
are used to determine the chokepoint potentials for every border AS. Finally, \toolname{} calclates the national breakthrough potential 
for each nation. In our experiments, we used the country codes returned from Team Cymru's
IP to ASN whois service \cite{cymru} to determine which ASes were registered to which nation. 
This service only maintains the most recent registration of each AS, so to control for uncertain country to AS links
we keep ASes that have been registered more recently than the current timestam being tested in the path simulation but we do not assign these ASes chokepoint potentials. We 
chose this route because the datasets of AS registrations for the various ASN registries tended to have more missing data at specific timestamps.
Fortunately, ASes with registration changes after each test date tend to not be in the AS graph for that test.

% Routing Tree Algorithm
\par
In order to calculate the routing trees, we use an extended version of the BGPSim algorithm developed by Gil et. al in \cite{quicksand}. In
our work we addressed the following limitations of BGPSim: (1) BGPSim returns a set of ASes for each path it considers but not the order in which
they are visited; (2) Once routing trees are determined, they cannot be accessed later without recalculation; (3) BGPSim relies on the outdated parallelization
framework DryadLinq for C\#. To address these issues, we use a Python implementation we dub BGPSimPy. BGPSimPy returns ordered paths from its routing trees,
saves routing trees to disk after calculation, and is parallelized with MPI via the mpi4py library. These improvements have the added benefit of yielding a cross platform
routing tree algorithm that is ready to work on most hardware.

% Chokepoint calculation
\par
Once BGPSimPy generates the routing trees, they can be processed to determine chokepoint potentials. This is done by iterating over every path between each AS-pair. Because
we use the same random tie-break as BGPSim, there is only 1 path between each AS-pair considered, even if multiple exist in the routing tree. Once a path is determined, it is
traversed. For each AS visited, the number of paths intercepted by that AS is incremented. This is done for both in-to-out paths and out-to-in paths, so only one traversal is
necessary per path. Additionally, the number of paths of each type that belong to each nation is tallied, as this makes up the denominator in equation \ref{eqn:chokePointPotential}.
\toolname{} takes the resulting chokepoint potentials and generates national breakthrough potentials for each nation.

\section{Experimental Setup}

% Chokepoint Evolution
There is ongoing research interest into ASes that intercept large portions of Internet paths \cite{throats}, \cite{decoy}. Some important questions remain unanswered however. For instance, to what
extent does the current state of the Internet support national governments' attempts to censor Internet traffic? How does this vary from nation to nation? Is the Internet developing more
powerful chokepoints, or becoming more evenly accessible?
\par
To probe these questions we first used our chokepoint evaluation technique to investigate the chokepoint potential of all nations for the current Internet as well as the
change in chokepoint potentials over time. We looked at multiple snapshots of AS relationships from the CAIDA dataset (2012-2018).
For each timestamp, we generated routing trees based on these relationships. Then we calculated the chokepoint potential for every border AS per snapshot. As a result we can investigate
how countries have changed overtime in their capability to enact censorship and surveillance. This is an attempt to understand what topological trends have developed historically.
With this test we can compare nations, and see which ones have overtime increased their capability to control the flow of information across their borders.
\par
% Chokepoints and Internet Freedom
If chokepoint potential can be leveraged to determine if a nation can easily implement censorship, it stands to reason that their might already be a negative relationship between
the chokepoint potential of a nation and its Internet freedom. If a significant relationship were to be found it would strengthen chokepoint potential as a measure of a nation's censorship capability
and it would increase the value in monitoring chokepoint potentials across the globe.
\par
We tested whether a significant relationship exists between our measure of national chokepoints and a qualitative evaluation of Internet Freedom. For Internet Freedom we used
the Freedom House's Freedom On The Net report \cite{FOTN}. FOTN scores quantify the level of Internet freedom in countries. Each country receives a numerical score from 0 (the most free)
to 100 (the least free). We compare our results to the FOTN scores by ranking nations according to national breakthrough potential, particulary the number of border ASes required to intercept
90\% of paths for each nation and viewing these rankings against the FOTN scores.

\section{Results}
\subsection{Nations Over Time}

\begin{figure}
	\centering
	\includegraphics[width=\linewidth]{NodesFree}
	\caption{The number of border ASes required for the US, France, Germany, and Great Britain to intercept 90\% of in-to-out paths over time.}\label{fig:nodesFree}
\end{figure}
\begin{figure}
	\centering
	\includegraphics[width=\linewidth]{NodesCensor}
	\caption{The number of border ASes required for Russia, Egypt, Turkey, and China to intercept 90\% of in-to-out paths over time.}\label{fig:nodesCensor}
\end{figure}
\begin{figure*}
	\centering
	\includegraphics[width=\textwidth]{multi}
	\caption{The capability for various nations to intercept in-to-out paths over multiple years \timerange. Each plot shows for a number of border ASes controlled (x-axis),
	what fraction of in-to-out paths are intercepted (y-axis). Years in blue are more recent, and years in red are further in the past.}\label{fig:multiTime}
\end{figure*}

We have chosen to detail the results of our experiment for 8 nations due to their histories of censorship practice. First we have chosen 4 nations known to enact
extensive Internet censorship policies. These nations are China, Turkey, Egypt, and Russia. China has historically been the number one nation in regards to Internet
censorship \cite{censorshipSurvey}. Turkey has recently dramatically increased its online censorship efforts, by blocking social media accesses during turmoil and pressuring ISPs
to block access to material chosen by the Turkish government \cite{turkeyCensor}. The Internet of Egypt suffered severe shutdowns during the Arab Spring of the early 2010s \cite{arabspring}.
The Russian government has passed surveillance laws requiring ISPs to allow the Russian government access to user statistics \cite{censorshipGeography}. Next we have chosen the nations
of Germany, the United States, France, and the United Kingdom because, while they have all conducted limited forms of Internet censorship \cite{censorshipSurvey}, Internet access for these 
nations is considered highly open.

\par
To inspect the changes over time for each nation we arrange all the border ASes belonging to a nation into a list. The list of border ASes is reverse sorted
so that the first AS has the highest chokepoint potential. The sum of all these chokepoint potentials is 1.0. Then we step through the list, and record
the cumulative chokepoint potential of all the ASes seen so far. If we plot the number of ASes controled vs the cumulative chokepoint potential for that number
of ASes, we can see how many ASes are required for a certain nation to control different percentages of paths. We repeat this process for each snapshot to highlight
changes over time.

\par
For instance, consider \figurename \ref{fig:multiTime}. 
The x-axis (log-scale, so that countries with large differences in AS counts can be compared more easily) for each plot
is the number of border ASes controlled, and the y-axis is the ratio of in-to-out paths intercepted. Each line represents a different snapshot, with the more red lines being
farther in the past and more blue lines being more recent.

\par
The United States and China are shown here and exhibit some dramatic differences. First, it is worth pointing out that the United States has many more ASes than China, hence
it's line extends further to the right in these plots. We also see that China, in all cases, can control a much larger portion of its paths with much fewer ASes than the
United States. This result is entirely expected. Of more interest is the trends that can be seen over time. The AS-level topology of China's Internet has evolved such that very few
ASes can intercept nearly all BGP paths. The US has evolved in a different way. While it has become somewhat easier for the US to intercept most of its paths, it has become
more difficult to intercept around 70\% of its paths and higher. This suggest an expansion of ASes on the interior and more connections, as well as a strengthening of
the very top ASes.

\par
Not all nations have evolved to a state where it easier to control paths. One example is Germany, as shown in \figurename \ref{fig:multiTime}. For Germany, a fairly constant
trend shows that it has become more difficult to intercept BGP paths. Unlike the other examples, any amount of German border ASes intercept less paths in more recent tests.

\par
In order to compare multiple nations, we have plotted the number of ASes needed to intercept 90\% of in-to-out paths
for each timestamp recorded. These results are detailed in \figurename \ref{fig:nodesFree} and \figurename \ref{fig:nodesCensor}.
The distinct behaviors of each nation are rather striking. We can see a steep decline for some
nations known to limit Internet freedom (China and Turkey) as well as the increase for other nations
(Germany and France). Other nations have stayed more stable. It is worth pointing out that if a nation
has required the same number of border ASes to control many paths over several years, this suggests
that the chokepoints have grown to intercept more paths. The reason for this is that the number of ASes,
and thus the number of paths, has increased globally over time. This fact makes the decline in ASes
needed for some nations even more glaring.


\subsection{Internet Freedom}

In our test of the relationship between Internet Freedom and national breakthrough potential, we plotted the Freedom on the Net score
of each nation vs the number of border ASes that that nation needed to in order to intercept 90\% of in-to-out paths. Additionally,
we evaluated the relationship with an Ordinarly Least Squares (OLS) fit, and found that the relationship was statistically significant,
with a p-value $\leq$ 0.002 for 2017. The relationship held for other timestamps as well. The results for 2017 are shown in figure \ref{fig:fotn}

\begin{figure}
	\centering
	\includegraphics[width=\linewidth]{fotn}
	\caption{The National Breakthrough Potential (in-to-out) for nations plotted against the FOTN score
	of those nations in 2017. A higher FOTN score indicates a less free nation. Our OLS fit is also plotted.}\label{fig:fotn}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=\linewidth]{fotp}
	\caption{The National Breakthrough Potential (in-to-out) for nations plotted against the FPI
	of those nations in 2017. A higher FPI indicates a less free nation. Our OLS fit is also plotted.}\label{fig:fotp}
\end{figure}

\par
For each timestamp we see what appears to be two general modes of behavior. Nations that are not free or partly free tend to requrie few ASes
to intercept 90\% of their paths. Free nations on the otherhand require varying degrees of large numbers of ASes to control the same portion
of their paths. There are interesting outliers for both situations, however. Countries like Estonia (EE) or Iceland (IS) are very free but require
few border ASes to control most of their paths. The reason for these outliers is likely that their overall AS counts are very low. On the other hand, Russia (RU)
is a very interesting outlier in that it is found to be not free by FOTN, but requires a large number of ASes to control most of its paths. This suggests
that the censorship efforts in Russia might be of types that do not require AS level chokepoints.

\section{Related Work}   
\par
Previous studies have used BGP path models to find ASes that
intercept a high fraction of paths. One such project in \cite{throats}
identified that 90\% of paths on the Internet could be intercepted with only 30
or so ASes. The researchers in \cite{throats} generated paths by first using
only paths to top websites as defined by the Alexa top websites project,
and then appending additional edges to those paths from the full
AS graph according to the principles defined by Gao \cite{gao}. Many of the
ASes that were found to intercept a large number of paths were found to be
within nations that conduct censorship. As an extension of these results,
another paper \cite{decoy} revealed that ASes that intercept many paths could
be utilized for decoy routing. This approach for identifying AS level
chokepoints has several potential pitfalls that are remedied by the approach
taken in this paper. First, the authors in \cite{throats} didn't consider that
many of the paths found from the Alexa top websites would have destinations in
nations that censor Internet traffic, particularly China due to its large
Internet population. This artificially inflates the chokepoint nature of
Chinese ASes. As an alternative, in this paper we consider paths from every
source-destination AS pair, and we make a distinction between in-to-out paths
and out-to-in paths. Secondly, chokepoints have previously only been
identified at a single snapshot of the Internet. This makes it difficult to
discuss the evolution of Internet topology, and whether or not chokepoints are
anomalous or common. Finally, the aforementioned approach for identifying
chokepoints does not allow a clear comparison between different nations. It
can be said that one nation controls a large portion of Internet paths, but
not how easily traffic directed through that country could be intercepted on a
national level. For this, some aggregate measure across all of the border ASes
within a country must be considered, as it is in this paper.     
\par
In \cite{chinafiltering}, Xu et al. investigated the AS level topology of China
to identify where keyword filtering occurred. They found that the most
effective ASes with which to deploy keyword filtering devices are those in the
backbone of the Chinese AS topology. A relevant contribution of
\cite{chinafiltering} is that, while most filtering occurs in border ASes,
some filtering at the time of the study was controlled by non-central provincial
ASes. China had a
diverse strategy for Internet censorship, both targeting chokepoints and the
Chinese provincial network, but this may have changed since. The potential for various forms of censorship in
regards to various AS level topologies motivates the question: Is centralized
censorship or decentralized censorship more common? Instead of directly
identifying censorship devices on the AS graph, we instead quantify the
chokepoint potential of ASes on the national level, and then compare that with
qualitative Internet freedom measures and empirical censorship events.
\par
We are not the first to investigate the relationship between Internet freedom and
AS-level topology. Similar techniques have been used to classify nations according
to the connectivity of their ASes \cite{politicsrouting}. This has only been done for a
single moment in time, however, making the results limited in terms of stability and predictability.
Additionaly, previous work has not used country level chokepoints as the link between Internet topology
and censorship or surveillance practices. The work in \cite{politicsrouting} chose to relate Internet topology
to the Freedom of the Press measure from freedom house instead of the Freedom On The Net score. They chose to do this
to include more nations. Additionally, this study didn't include the United States and Russia in their experiments because they were
outliers in regards to their topologies. Through our approach we hope to extend this previous work by finding an interesting measure for
understanding the dynamics of all nations, as well as targeting our results more specifically to Internet freedom by using the Freedom On
The Net score as our measure for Internet freedom. Through our techniques, we provide a simple measure that not only 
sheds light on the relationship between topology and Internet freedom, but reveals currently free
nations that could easily implement censorship if their governments decided to.


\section{Conclusions and Discussion}

% Chokepoint Potential
In this paper we have introduced two novel measures, chokepoint potential, on single border ASes,
and national breakthrough potential, on entire nations, that together allow us to
evaluate the level of difficulty that a government faces when trying to censor the Internet
based entirely on AS-level topology. Our technique for evaluating AS-level topology using
\toolname{} provides a monitoring capability of BGP dynamics that was previously not possible.
We have taken advantage of efficient simulation, standard AS relationship datasets, and cross-platform
design principles so that this tool is readily deployable for future research.
% Ecolution over time
\par
Our application of \toolname{} to investigate evolution of the global AS graph over time shows us
interesting trends in AS topologies. We have identified the apparent lack of major nations to develop
more open Internet borders and gateways, despite the increasing connectivity and size of the AS graph. Additionally,
we find that the chokepoints in some nations known to conduct censorship and surveillance have increased in strength.
% Internet Freedom
\par
We have validated national breakthrough potential as having a relationship to actual censorship by showing
the significance of the relationship between the chokepoint potential of nations and the evaluations of freedom provided
by both freedom on the net and freedom of the press. This relationship implies that when censorship and surveillance are being evaluated
at the national level, it is worthwhile to consider the border AS chokepoints that are resident to the nation in question.

\subsection{Routing Trees Dataset}
In the hope to further AS topology research, we have open sourced the routing tree datasets generated in this study. While we generated routing trees
with an efficient algorithm, it still requires considerable time to calculate them, particulary for multiple timestamps. Additionally, each set of routing trees
takes up on the order of 50GB of disk space. By releasing these datasets we hope that researchers looking for a particular set of routing trees will find
working with these simpler than recalculating them. This also provides an alternative to research projects that might otherwise use measurement tools to estimate
BGP paths.

% Points of Presence
\subsection{Other Chokepoint Measures}
There are several ways that a country can create chokepoints, either intentionally or accidentally: taking advantage of Internet Exchange Points (IXPs),
limiting the number of physical connections that cross the border, centralizing
the DNS infrastructure within the country, or working
with---and supporting---a set of ISPs that have international connections.
Each of these combines two basic elements: limiting the number of organizations that the government must interact with and creating physical locations where traffic can be controlled.
We chose to define chokepoint potential in terms of the AS graph instead of physical locations because the AS graph captures the most interesting physical attributes of the Internet, and
virtualization of the physical and datalink layers on the Internet make physical locations less meaningful. A single undersea cable can be multiplexed to serve as several different links in
the AS graph, and ASes in one country can have physical Points of Presence (PoPs) in several other countries (e.g., China Telecom in Pasadena, California). Thus, the AS graph is a good approximation
of overall chokepoint potential, and information such as geography and the physical locations of routers does not add meaningfully to the analysis without considering every individual piece of Internet
infrastructue on a case-by-case basis. Additionally, the dramatic shifts in chokepoint potential over time depicted in our analysis are unrelated to constant geography, so our AS-level study is important
to show time evolution of chokepoints.

The DNS infrastructure is another potential graph where chokepoints can be
exploited for censorship and surveillance\~cite{Greschbach2016a} and is at a
higher layer in the network stack than IP routes.  However, we leave analysis of
this graph for future work because it is outside the scope of \toolname{} and
because the countries that rely on DNS as their main form of censorship are
fewer in number and are among the least sophisticated in terms of their
censorship regime.

\subsection{Future Work}
% OONI data
While linking chokepoint potential to FOTN scores is a substantial contribution, it still stands that FOTN can serve only as a proxy for censorship.
This is useful for large trends and general understanding, but a more fine-grained approach could be used to interpret the direct connection between
actual censorship events and the shifts in the AS graph. The Open Observatory of Network Interference, or OONI, \cite{OONI} provides Internet users around
the world with a tool called the ooniprobe. The ooniprobe lets users run a suite of tests to identify censorship anamolies of various types, and the results are
recorded in the large OONI database. Matching up changes in OONI measurements, such as increased censorship campaigning in an authoritarian nation, with shifts
in chokepoint potential would be a major step in understanding the interplay of censorship and AS-level chokepoints. This process involves designing a way to classify
censorship events and chokepoint potential changes, and as such lies beyond the scope of this study.

\bibliographystyle{plain}
\bibliography{paper}

\end{document}
